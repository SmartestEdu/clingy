"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),Clingy=function(){function e(n,t,i){_classCallCheck(this,e),this.$rootScope=n,this.$window=t,this.clingies=[],this.clingyProvider=i,this.eventIsBoundForState=!1,this.eventIsBoundForWindow=!1,this.unregisterRootScopeListener=angular.noop}return _createClass(e,[{key:"addEventListeners",value:function(){!0===this.clingyProvider.listenForWindowUnload&&!1===this.eventIsBoundForWindow&&(this.$window.onbeforeunload=this.pleaseDontLeaveMe.bind(this),this.eventIsBoundForWindow=!0),!0===this.clingyProvider.listenForStateChange&&!1===this.eventIsBoundForState&&(this.unregisterRootScopeListener=this.$rootScope.$on("$stateChangeStart",this.pleaseDontLeaveMe.bind(this)),this.eventIsBoundForState=!0)}},{key:"cling",value:function(e){var n,t=this.generateUniqueId();if("string"!=typeof e)throw new TypeError("Invalid message provided. I need something to say if you want me to cling!");return n={id:t,breakup:function(){this.clingies=this.clingies.filter(function(e){return e.id!==t}),this.removeEventListeners()}.bind(this),message:e},this.clingies.push(n),this.addEventListeners(),n.breakup}},{key:"generateUniqueId",value:function(){return[(new Date).getTime(),Math.round(1e6*Math.random())].join(".")}},{key:"isClingy",value:function(){return 0!==this.clingies.length}},{key:"pleaseDontLeaveMe",value:function(e){var n,t=[];return!1!==this.isClingy()?(this.clingies.forEach(function(e){-1===t.indexOf(e.message)&&t.push(e.message)}),t=1===t.length?t.join(""):t.map(function(e){return"â€¢ "+e}).join("\n"),"$stateChangeStart"===e.name?(n=!confirm(t),1==n&&e.preventDefault(),n):t):void 0}},{key:"removeEventListeners",value:function(){!0!==this.isClingy()&&(this.$window.onbeforeunload=void 0,this.unregisterRootScopeListener(),this.eventIsBoundForState=!1,this.eventIsBoundForWindow=!1)}}]),e}();exports["default"]=Clingy,module.exports=exports["default"];
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),_Clingy=require("Clingy"),_Clingy2=_interopRequireDefault(_Clingy),ClingyProvider=function(){function e(){_classCallCheck(this,e),this.$get=["$rootScope","$window",function(e,n){return new _Clingy2["default"](e,n,this)}],this.listenForStateChange=!1,this.listenForWindowUnload=!0}return _createClass(e,[{key:"setListenForStateChange",value:function(e){return this.listenForStateChange=e,this}},{key:"setListenForWindowUnload",value:function(e){return this.listenForWindowUnload=e,this}}]),e}();angular.module("clingy",[]).provider("clingy",ClingyProvider);
//# sourceMappingURL=clingy.js.map